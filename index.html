<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>JSON/Text Converter</title>
<style>
  :root {
    --background: #FFFFFF;
    --surface: #F8F9FA;
    --primary: #6B2EDA;
    --primary-dark: #4F21A6;
    --text: #1A1A1A;
    --subtext: #555555;
    --accent: #9C63FF;
    --accent-light: #DCD4FF;
  }
  @media (prefers-color-scheme: dark) {
    :root {
      --background: #0E0C17;
      --surface: #1A1629;
      --primary: #8A5BFF;
      --primary-dark: #5F3CB8;
      --text: #EDEDED;
      --subtext: #B0B0B0;
      --accent: #C78DFF;
      --accent-dark: #925BCC;
    }
  }

  body {
    background: var(--background);
    color: var(--text);
    font-family: Arial, sans-serif;
    padding: 20px;
    margin: 0;
  }
  h1 { color: var(--primary); }

  .toolbar {
    margin-bottom: 10px;
    display: flex;
    gap: 10px;
  }

  textarea {
    width: 100%;
    height: 150px;
    background: var(--surface);
    border: 2px solid var(--accent);
    color: var(--text);
    padding: 10px;
    font-family: monospace;
    font-size: 14px;
    border-radius: 8px;
    box-sizing: border-box;
    margin-bottom: 10px;
  }

  button {
    background-color: var(--primary);
    color: white;
    border: none;
    padding: 10px 20px;
    font-size: 16px;
    border-radius: 8px;
    cursor: pointer;
  }

  button:hover { background-color: var(--primary-dark); }

  #output {
    margin-top: 20px;
    background: var(--surface);
    padding: 10px;
    border-radius: 8px;
    border: 2px solid var(--accent-light);
    white-space: pre-wrap;
    word-wrap: break-word;
    overflow-wrap: break-word;
    min-height: 100px;
    position: relative;
  }

  .buttons {
    margin-top: 5px;
    display: flex;
    gap: 10px;
  }

  .buttons span {
    cursor: pointer;
    font-size: 20px;
    color: var(--accent);
  }
</style>
</head>
<body>

<h1>JSON / Text Converter</h1>

<label>
  <input type="radio" name="mode" value="jsonToText" checked> JSON â†’ Text
</label>
<label>
  <input type="radio" name="mode" value="textToJson"> Text â†’ JSON
</label>

<div class="toolbar">
  <button id="pasteBtn">ðŸ“‹ Paste</button>
  <button id="convertBtn">Convert</button>
</div>

<textarea id="inputArea" placeholder="Paste JSON or text here..."></textarea>

<div id="output"></div>
<div class="buttons">
  <span id="speakerBtn" title="Read Aloud">&#128266;</span>
  <span id="copyBtn" title="Copy">&#128203;</span>
</div>

<script>
const inputArea = document.getElementById('inputArea');
const convertBtn = document.getElementById('convertBtn');
const pasteBtn = document.getElementById('pasteBtn');
const outputDiv = document.getElementById('output');
const speakerBtn = document.getElementById('speakerBtn');
const copyBtn = document.getElementById('copyBtn');

let currentText = '';
let currentMode = 'jsonToText';

document.querySelectorAll('input[name="mode"]').forEach(radio => {
  radio.addEventListener('change', () => {
    currentMode = radio.value;
    outputDiv.textContent = '';
    currentText = '';
  });
});

// Paste button
pasteBtn.addEventListener('click', async () => {
  try {
    const text = await navigator.clipboard.readText();
    inputArea.value = text;
  } catch (e) {
    alert('Failed to read clipboard: ' + e.message);
  }
});

// Convert button
convertBtn.addEventListener('click', () => {
  const input = inputArea.value.trim();
  if (!input) {
    alert('Please enter input');
    return;
  }
  try {
    if (currentMode === 'jsonToText') {
      const obj = JSON.parse(input);
      currentText = jsonToText(obj);
    } else { // textToJson
      currentText = JSON.stringify(textToJson(input), null, 2);
    }
    outputDiv.textContent = currentText;
  } catch (e) {
    outputDiv.textContent = 'Error: ' + e.message;
  }
});

// JSON â†’ Text conversion
function jsonToText(obj, indent = 0) {
  let text = '';
  const space = '  '.repeat(indent);
  if (typeof obj === 'object' && obj !== null) {
    if (Array.isArray(obj)) {
      obj.forEach(item => { text += space + '- ' + jsonToText(item, indent + 1).trim() + '\n'; });
    } else {
      for (const key in obj) {
        text += space + key + ': ';
        if (typeof obj[key] === 'object' && obj[key] !== null) {
          text += '\n' + jsonToText(obj[key], indent + 1);
        } else {
          text += obj[key] + '\n';
        }
      }
    }
  } else {
    text += obj + '\n';
  }
  return text;
}

// Text â†’ JSON conversion
function textToJson(text) {
  const obj = {};
  const lines = text.split('\n').filter(l => l.trim() !== '');
  lines.forEach(line => {
    const idx = line.indexOf(':');
    if (idx > 0) {
      const key = line.slice(0, idx).trim();
      const val = line.slice(idx + 1).trim();
      obj[key] = isNaN(val) ? val : Number(val);
    }
  });
  return obj;
}

// Speaker button
speakerBtn.addEventListener('click', () => {
  if (!currentText) return alert('Nothing to read');
  if (!window.speechSynthesis) return alert('SpeechSynthesis not supported');
  speechSynthesis.cancel();
  const utterance = new SpeechSynthesisUtterance(currentText);
  utterance.rate = 1;
  utterance.pitch = 1;
  speechSynthesis.speak(utterance);
});

// Copy button
copyBtn.addEventListener('click', () => {
  if (!currentText) return alert('Nothing to copy');
  navigator.clipboard.writeText(currentText)
    .then(() => alert('Copied to clipboard'))
    .catch(() => alert('Copy failed'));
});
</script>

</body>
</html>
